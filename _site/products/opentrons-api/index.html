<!doctype html> <html class="no-js" lang="en"> <head> <meta charset="utf-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Python API: Moving Liquids</title> <link rel="stylesheet" href="https://andysigler.github.io/assets/css/styles_feeling_responsive.css"> <script src="https://andysigler.github.io/assets/js/modernizr.min.js"></script> <script> WebFontConfig = { google: { families: [ 'Lato:400,700,400italic:latin', 'Volkhov::latin' ] } }; (function() { var wf = document.createElement('script'); wf.src = ('https:' == document.location.protocol ? 'https' : 'http') + '://ajax.googleapis.com/ajax/libs/webfont/1.5.6/webfont.js'; wf.type = 'text/javascript'; wf.async = 'true'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(wf, s); })(); </script> <noscript> <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic%7cVolkhov' rel='stylesheet' type='text/css'> </noscript> <meta name="google-site-verification" content="" /> <meta name="msvalidate.01" content="" /> <meta name="description" content="Designed the pipette actions, and programmed their movement within the Opentrons liquid-handler Python API"/> <link rel="author" href=""/> <link rel="icon" sizes="32x32" href="https://andysigler.github.io/assets/img/favicon.ico"> <link rel="icon" sizes="192x192" href="https://andysigler.github.io/assets/img/touch-icon-192x192.png"> <link rel="apple-touch-icon-precomposed" sizes="180x180" href="https://andysigler.github.io/assets/img/apple-touch-icon-180x180-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://andysigler.github.io/assets/img/apple-touch-icon-152x152-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://andysigler.github.io/assets/img/apple-touch-icon-144x144-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://andysigler.github.io/assets/img/apple-touch-icon-120x120-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://andysigler.github.io/assets/img/apple-touch-icon-114x114-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://andysigler.github.io/assets/img/apple-touch-icon-76x76-precomposed.png"> <link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://andysigler.github.io/assets/img/apple-touch-icon-72x72-precomposed.png"> <link rel="apple-touch-icon-precomposed" href="https://andysigler.github.io/assets/img/apple-touch-icon-precomposed.png"> <meta name="msapplication-TileImage" content="https://andysigler.github.io/assets/img/msapplication_tileimage.png"/> <meta name="msapplication-TileColor" content="#fabb00"> <!-- Facebook Optimization --> <meta property="og:locale" content="en_EN" /> <meta property="og:type" content="website" /> <meta property="og:title" content="Python API: Moving Liquids" /> <meta property="og:description" content="I make things."/> <meta property="og:url" content="https://andysigler.github.io/products/opentrons-api/" /> <meta property="og:site_name" content="Andy Sigler" /> <meta property="og:image" content="https://andysigler.github.io/images/opentrons_api_small.png" /> <!-- Search Engine Optimization --> <link type="text/plain" rel="author" href="https://andysigler.github.io/humans.txt" /> </head> <body id="top-of-page" class=""> <div id="navigation" class="sticky" style="z-index:1100;background-color:white;"> <nav class="top-bar row" data-topbar> <ul class="title-area"> <li class="name"> <h1 class="show-for-small-only"><a href="https://andysigler.github.io" class=""> </a></h1> </li> <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone --> <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li> </ul> <section class="top-bar-section"> <ul class="right"> <li class="divider"></li> <li><a href="https://andysigler.github.io/">Work</a></li> <li class="divider"></li> <li><a href="https://andysigler.github.io/blog/">Blog</a></li> <li class="divider"></li> <li><a href="https://andysigler.github.io/about/">About</a></li> </ul> <ul class="left"> </ul> </section> </nav> </div><!-- /#navigation --> <div class="row t30"> <div class="medium-10 columns medium-offset-1 end"> <article itemscope itemtype="http://schema.org/Article"> <header> <span itemprop="name" class="avoidMe"> <div class="subheadline">Opentrons Pipette API and Motion Control</div><br /> <h1 class="matchbook" style="font-size:60px">Python API: Moving Liquids</h1> </span> </header> <p class="teaser" itemprop="description"> Designed the pipette actions, and programmed their movement within the Opentrons liquid-handler Python API </p> <span itemprop="articleSection"> <video id="vid_aspirate" style="width:100%;max-width:400px; height:auto; border:1px solid #aaa" width="854" height="480" controls="" loop="" muted=""> <source src="https://andysigler.github.io/images/aspirate-loop.webm" type="video/webm" /> <source src="https://andysigler.github.io/images/aspirate-loop.ogv" type="video/ogg" /> <source src="https://andysigler.github.io/images/aspirate-loop.mp4" type="video/mp4" /> </video> <script type="text/javascript"> var vid_aspirate = document.getElementById('vid_aspirate'); vid_aspirate.removeAttribute('controls'); vid_aspirate.addEventListener('canplaythrough', function(e){ vid_aspirate.play(); }) </script> <p>The <a href="https://docs.opentrons.com/">Opentrons API</a> is an opensource software interface, written in Python, to control the set of Opentrons liquid-handlers. It was designed allow simple commands to perform relatively complex procedures, while at the same time exposing a lower level that gives the author control over the machine’s atomic movements.</p> <p><img src="https://andysigler.github.io/images/opentrons_api_contributions_chart.png" alt="API Contributions" /></p> <p>In the chart above, <strong style="color:#EEA33B">my contributions are shown in orange</strong>.</p> <p>From 2016-2018, I designed and programmed an important piece of the Python API; the automated-liquid-handling portions. Specifically, it starts at the high-level user protocol commands, and moves down through individual pipette movements, all the way down to programming motor spins.</p> <p><br /></p> <h2 id="my-contributions">My Contributions</h2> <p>Within the Opentrons Python API, mostly working on:</p> <ul> <li>Designing protocol commands</li> <li>Designing pipette actions</li> <li>Programming pipette movements</li> <li>Programming motion control and hardware abstraction</li> </ul> <p>Here’s a video demoing my work. It shows protocol commands creating real-world liquid transfers:</p> <video id="vid_demo" style="width:100%;max-width:600px; height:auto; border:1px solid #aaa" width="1280" height="720" controls="" loop="" muted=""> <source src="https://andysigler.github.io/images/opentrons_api.webm" type="video/webm" /> <source src="https://andysigler.github.io/images/opentrons_api.ogv" type="video/ogg" /> <source src="https://andysigler.github.io/images/opentrons_api.mp4" type="video/mp4" /> </video> <!-- <script type="text/javascript"> var vid_demo = document.getElementById('vid_demo'); vid_demo.removeAttribute('controls'); vid_demo.addEventListener('canplaythrough', function(e){ vid_demo.play(); }) </script> --> <p>As part of a team of four software developers in 2016, I played an outsized role in shaping the interface of the API. From experience in using the <a href="https://shop.opentrons.com/collections/ot-one-s-robot-and-accessories">OT-One</a>, plus having solely writting the <a href="https://andysigler.github.io/projects/opentrons-platform-prototype">platform’s Kickstarter version all in Javascript</a>, I new it was important to allow both lower-level control of liquid transfers, while giving another option for simple transfers. This allowed the API to satisfy both simple needs and programming beginners, as well as more complex procedures and those with Python experience.</p> <p>In addition to leading design of the API’s interface, I spent considerable time in 2016 for the OT-One and in 2017 for the OT2 writing the motion control aspect of the Opentrons software. This includes how a pipette moves around, what parameters are required to allow fine control of liquid transfers, software interfaces for controlling the stepper-motor-driving system, and finally communication with the machine’s stepper-motor-driver through GCode.</p> <p>See the project live <a href="https://github.com/opentrons/opentrons">on GitHub</a>, and <a href="https://docs.opentrons.com/atomic%20commands.html">read the docs</a></p> <!-- ## How to Use: Python API Tutorial Python was chosen to drive the Opentrons' backend because of the language's prevalence in the scientific community. So because we're working with Python, we need to first import our instruments (the pipettes) and our labware (the plates, tip-racks, etc.): <figure class="highlight"><pre><code class="language-python3" data-lang="python3">from opentrons import instruments, labware</code></pre></figure> Before we can get started, we need to know about [the Opentrons deck](https://docs.opentrons.com/labware.html#placing-labware-on-the-robot-deck). This is a set of slotted inserts that fit standard labware, so they do not move during a protocol. You'll notice in the picture below that each "slot" on the deck is numbered, so that when our protocol creates a new labware we can easily assign it's location to a numbered slot. ![Opentrons Deck](https://andysigler.github.io/images/opentrons-deck-small.png) ![Opentrons Deck](https://andysigler.github.io/images/opentrons-full-deck-small.jpg) Now let's pretend we have a [trough](https://docs.opentrons.com/labware.html#troughs) filled with some sample, and we want to transfer that sample to a [well plate](https://docs.opentrons.com/labware.html#pcr-flat). The software contains accurate three-dimensional representations of these labwares, and the API can load them into your protocol like so: <figure class="highlight"><pre><code class="language-python3" data-lang="python3">trough = labware.load('trough-12row', slot='1')
plate = labware.load('96-PCR-flat', slot='2')</code></pre></figure> Next we need a [pipette](https://docs.opentrons.com/pipettes.html), which also need a [tip rack](https://docs.opentrons.com/labware.html#tipracks) which holds disposable tips for sterile liquid transfers. For the pipettes, let's use a 300uL single-channel, and put it on the OT2's left mount: <figure class="highlight"><pre><code class="language-python3" data-lang="python3">tips = labware.load('opentrons-tiprack-300ul', slot='3')
pipette = instruments.P300_Single(mount='left', tip_racks=[tips])</code></pre></figure> With our labware and pipettes ready, we can start transferring liquids! As of this writing, the API has loosely speaking two layers of liquid-handling commands, the documentation names "atomic" and "complex". The [atomic commands](https://docs.opentrons.com/atomic%20commands.html) can be thought of as individual movements, controllable and sequencable through the API. Below are a set of atomic commands which do the following: - Pick up a new tip from the tip rack - Aspirate 100uL from the trough's A1 position - Dispense 100uL to the plate's A1 position - Drop the tip inside the deck's trash <figure class="highlight"><pre><code class="language-python3" data-lang="python3">pipette.pick_up_tip()
pipette.aspirate(100, trough.wells('A1'))
pipette.dispense(100, trough.wells('A1'))
pipette.drop_tip()</code></pre></figure> To add some complexity, we can fit in a few more atomic commands to give even more fine-tuned control over the liquid's movement: <figure class="highlight"><pre><code class="language-python3" data-lang="python3">pipette.pick_up_tip()
pipette.aspirate(100, trough.wells('A1'))
pipette.touch_tip()
pipette.air_gap(20)
pipette.dispense(100, trough.wells('A1'))
pipette.blow_out()
pipette.drop_tip()</code></pre></figure> To make it easier to read, you can also chain together pipette commands: <figure class="highlight"><pre><code class="language-python3" data-lang="python3">pipette.pick_up_tip()
pipette.aspirate(100, trough.wells('A1')).touch_tip().air_gap(20)
pipette.dispense(100, trough.wells('A1')).blow_out()
pipette.drop_tip()</code></pre></figure> The [complex commands](https://docs.opentrons.com/complex%20commands.html) are one level higher, and hide the many details you are show when using atomic commands. To perform a similar liquid transfer as above, we can us the following complex command: <figure class="highlight"><pre><code class="language-python3" data-lang="python3">pipette.transfer(100, trough.wells('A1'), plate.wells('A1'))</code></pre></figure> That single line will automatically pick up a tip, transfer the 100uL, then drop the tip. These complex commands are much easier to understand, more approachable to beginners, while the trade-off is less control. There is much more detail you can read in the documentaion linked to throughout this post. --> </span> <div id="page-meta" class="t30"> <p> <!-- Look the author details up from the site config. --> <!-- Output author details if some exist. --> <time class="icon-calendar pr20" datetime="2019-02-03" itemprop="datePublished"> 2019-02-03</time> <span class="icon-archive pr20"> PRODUCTS</span> <br> <span class="pr20"><span class="icon-price-tag pr10"> automation</span> </span> </p> <div id="post-nav" class="row"> <div class="small-5 columns"><a class="button small radius prev" href="https://andysigler.github.io/projects/magnetic-hue-light-controller/">&laquo; Magnetic Hue Light Controller</a></div><!-- /.small-4.columns --> <div class="small-5 columns text-right"><a class="button small radius next" href="https://andysigler.github.io/products/tomorrow-lab/">Tomorrow Lab &raquo;</a></div><!-- /.small-4.columns --> </div> <p><a href="https://andysigler.github.io/blog/archive/" title="Blog /blog/archive">/blog/archive</a></p><!-- /.small-4.columns --> </div><!-- /.page-meta --> </article> </div><!-- /.medium-8.columns --> </div><!-- /.row --> <script src="https://andysigler.github.io/assets/js/javascript.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-57970756-2', 'auto'); ga('set', 'anonymizeIp', true); ga('send', 'pageview'); </script> </body> </html>
